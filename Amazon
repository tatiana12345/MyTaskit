import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.firefox.FirefoxDriver;

public class Amazon {
	
	public static void Condition() {
		
		//Condition. Turn page         
		WebDriver wd = new FirefoxDriver();
		
			for (int i=0; i<5; i++){
			
			int isPresent = wd.findElements(By.id("pagnNextString")).size();
				
				if (isPresent  > 0){
					wd.findElement(By.id("pagnNextString")).click();
				}
		       
				else {
			    System.out.println("Reached last page");
				}} 
			}
				
	public static void main(String[] args) throws InterruptedException {
	// Amazon

		String[] Item_info = {"volumizer", "dishwasher"}; 

		double findMinPrice = 0;
		
		String Product = null;
		
		for (int i=0; i<20; i++)
		{
		double minPrice = myFunction(Item_info[i]);
		//System.out.println("The price of " + Item_info[i] + " is " + minPrice);
		
	if (findMinPrice == 0 || findMinPrice> minPrice ){
		findMinPrice = minPrice;
		Product = Item_info[i];
	}
		}
		System.out.println("The cheapest price of: " + Product + findMinPrice);
	} 

	public static double myFunction(String item_info) throws InterruptedException {
		
		//1. Launch Amazon
		
		WebDriver wd = new FirefoxDriver();
		wd.get("http://www.amazon.com/");
		
		//2.Click drop down menu
		wd.findElement(By.xpath("//div[@class='nav-search-facade']")).click();
		
		//3. Click a category (variable)
		wd.findElement(By.xpath("//option[contains(text(), 'Electronics')]")).click();
		
		//4. Type a search text (variable)
		wd.findElement(By.id("twotabsearchtextbox")).sendKeys(new String[] {item_info});
		
		//Click Search
		wd.findElement(By.id("nav-search-submit-text")).click();
		
Thread.sleep(4000);		

		//Sort items from High to Low
		wd.findElement(By.id("sort")).click();
		wd.findElement(By.xpath("//option[contains(text(), 'Price: High to Low')]")).click();

        Thread.sleep(4000);		

        //Select an item on the page and capture the price
		wd.findElement(By.xpath("//a/img[@class='s-access-image cfMarker']")).click();
		String price = wd.findElement(By.id("priceblock_ourprice")).getText();
		
		//Capture the title
		String title = wd.findElement(By.id("productTitle")).getText();

		//11. Convert alphanumeric value to numeric, to use "double" 
		double Dprice = Double.parseDouble(price.replace("$",""));
		System.out.println(title + " The price is: " + price);
		wd.navigate().back();
		 
        Thread.sleep(5000);

        for (int i=0; i<5;){
	
	    int isPresent = wd.findElements(By.id("pagnNextString")).size();
		
		if (isPresent  > 0){
			wd.findElement(By.id("pagnNextString")).click();
		    }
		
	    }
	
        return Dprice;	
	
        }
	}
