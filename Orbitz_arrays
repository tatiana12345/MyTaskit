import org.openqa.selenium.WebDriver;
import org.openqa.selenium.firefox.FirefoxDriver;
		import org.openqa.selenium.By;

public class Orbitz_Arrays {

	public static void main(String[] args) throws InterruptedException {
		// Lesson 13
	
		String[] FROM = {"Toronto", "BOS", "LA", "MIA"};
		String[] TO = {"MIA", "JFK", "BOS", "Key West"};
		
		
		double findMinPrice = 0;
		
		String FROMdest = null;		
		String findDest = null;
		
		for (int i=0; i<TO.length; i++)
		{
		     double minPrice = myFunction(FROM[i], TO[i], "03/10/16", "03/17/16");

		     System.out.println("The lowest price from " + FROM[i] + " to " + TO[i] + " is: " + minPrice);
		
		     if (findMinPrice == 0 || findMinPrice > minPrice) {
		    	 findMinPrice = minPrice;
		    	 FROMdest = FROM[i];
		    	 findDest = TO[i];
			     
		     }
		
}
		System.out.println("The cheapest tickets from " + FROMdest + " to " + findDest + " is " + findMinPrice);
		
	}
	
	//Define "myFunction"	
			public static double myFunction(String FROM, String TO, String Arrive, String Depart) throws InterruptedException {
				
				
				//Variables Flights only
				        //Step 1: Open Firefox
				        WebDriver wd = new FirefoxDriver();	
				       
			   	       //Step 2: Launch Orbitz URL
						wd.get("http://www.orbitz.com/");
					
	Thread.sleep(6000);
							
						//Step 3: Click on 'Flight Only' tab		
						
	                    boolean isPresent = wd.findElements(By.xpath("//*[@alt='close']")).size() > 0;
	                    boolean isPresent2 = wd.findElements(By.xpath("//*[contains(text(), 'Flight only')]")).size() > 0;
	                    
	                    if (isPresent == true){						
		                    wd.findElement(By.xpath("//*[@alt='close']")).click();
								System.out.println("WD Closed popup");}	
	                    
	                    else if (isPresent2 == true){
							wd.findElement(By.xpath("//*[contains(text(), 'Flight only')]")).click();
							System.out.println("Radio-buttons Orbitz version");}
						
						else if (wd.findElement(By.xpath("//i[@class='i i-air tabIcon']")).isDisplayed()){
							wd.findElement(By.xpath("//i[@class='i i-air tabIcon']")).click();
							System.out.println("TABs Orbitz version");
				        }
				
	Thread.sleep(5000);
						//Step 5: Clear the field,enter 'From City' data 
						wd.findElement(By.name("ar.rt.leaveSlice.orig.key")).clear();
						wd.findElement(By.name("ar.rt.leaveSlice.orig.key")).sendKeys(new String[] {FROM});
						
						//Step 6: Enter 'To City' 
						wd.findElement(By.name("ar.rt.leaveSlice.dest.key")).clear();
						wd.findElement(By.name("ar.rt.leaveSlice.dest.key")).sendKeys(new String[] {TO});
						
						//Step 7: Enter 'Leave Date'
						wd.findElement(By.name("ar.rt.leaveSlice.date")).clear();
						wd.findElement(By.name("ar.rt.leaveSlice.date")).sendKeys(new String[] {Arrive});
						
						//Step 8: Enter 'Return Date' 
						wd.findElement(By.name("ar.rt.returnSlice.date")).clear();
						wd.findElement(By.name("ar.rt.returnSlice.date")).sendKeys(new String[] {Depart});
						
						//Step 9: Click on 'Search Flight'
						wd.findElement(By.name("search")).click();
						
	Thread.sleep(15000);
						
						//Step 10: Capture the price
						String price = wd.findElement(By.xpath("//span[@class='money small-cents small-symbol']")).getText();
						
						//11. Convert alphanumeric value to numeric, to use "double" 
						double dprice = Double.parseDouble(price.replace("$",""));
						
						wd.close();
						
						return dprice;		

		}

	}
